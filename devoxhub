wait("0.2")
-- Load Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- === Create main window ===
local Window = Rayfield:CreateWindow({
    Name = "DevoxHUB",
    Icon = 0,
    LoadingTitle = "DevoxHUB MS SCRIPT",
    LoadingSubtitle = "by Cylo",
    ShowText = "Rayfield",
    Theme = "Blood",
    ToggleUIKeybind = "K",
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false,
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "Big Hub"
    },
    Discord = {
        Enabled = true,
        Invite = "cEgVBaHcrz",
        RememberJoins = true
    },
    KeySystem = true,
    KeySettings = {
        Title = "Devox Key",
        Subtitle = "Key System",
        Note = "KEY IS IN DISCORD https://discord.gg/cEgVBaHcrz",
        FileName = "DevoxKey",
        SaveKey = true,
        GrabKeyFromSite = false,
        Key = {"DEVOXHUB123"}
    }
})

-- === Player tab ===
local PlayerTab = Window:CreateTab("Player", 4483362458)

-- === MAGS toggle ===
local magsEnabled = false
local debounce = false
local magConnection

local MagToggle = PlayerTab:CreateToggle({
    Name = "MAGS",
    CurrentValue = false,
    Flag = "MAGS_Toggle",
    Callback = function(value)
        magsEnabled = value

        if magsEnabled then
            magConnection = RunService.Heartbeat:Connect(function()
                local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then return end

                local region = Region3.new(
                    hrp.Position - Vector3.new(10, 10, 10),
                    hrp.Position + Vector3.new(10, 10, 10)
                )

                local footballs = workspace:FindPartsInRegion3(region, nil, math.huge)
                for _, football in ipairs(footballs) do
                    if football.Name == "Football" and football:IsA("BasePart") then
                        if (football.Position - hrp.Position).Magnitude < 10 then
                            if not debounce then
                                debounce = true
                                local leftArm = player.Character:FindFirstChild("Left Arm") or player.Character:FindFirstChild("LeftHand")
                                if leftArm then
                                    firetouchinterest(leftArm, football, 0)
                                    task.wait()
                                    firetouchinterest(leftArm, football, 1)
                                end
                                task.wait(0.2)
                                debounce = false
                            end
                        end
                    end
                end
            end)
        else
            if magConnection then
                magConnection:Disconnect()
                magConnection = nil
            end
        end
    end,
})

-- Keybind: M toggles MAGS
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.KeyCode == Enum.KeyCode.M then
        magsEnabled = not magsEnabled
        MagToggle:Set(magsEnabled)
    end
end)

-- === Football ESP Toggle (Animated 0 â†’ 18 studs, proper off) ===
local espEnabled = false
local espConnection
local espSphere
local animating = false

local function animateSphere(sphere, targetRadius)
    if not sphere then return end
    animating = true

    while animating and math.abs(sphere.Radius - targetRadius) > 0.1 do
        sphere.Radius = sphere.Radius + (targetRadius - sphere.Radius) * 0.2
        RunService.RenderStepped:Wait()
    end

    sphere.Radius = targetRadius
    animating = false
end

local FootballESPToggle = PlayerTab:CreateToggle({
    Name = "Football ESP",
    CurrentValue = false,
    Flag = "FootballESP_Toggle",
    Callback = function(value)
        espEnabled = value

        if espEnabled then
            espConnection = RunService.RenderStepped:Connect(function()
                local football = workspace:FindFirstChild("Football")
                if football and football:IsA("BasePart") then
                    if not espSphere then
                        espSphere = Instance.new("SphereHandleAdornment")
                        espSphere.Adornee = football
                        espSphere.Radius = 0
                        espSphere.Color3 = Color3.fromRGB(0, 0, 139)
                        espSphere.Transparency = 0.6
                        espSphere.AlwaysOnTop = true
                        espSphere.ZIndex = 5
                        espSphere.Parent = game.CoreGui
                        task.spawn(function()
                            animateSphere(espSphere, 9)
                        end)
                    else
                        espSphere.Adornee = football
                    end
                else
                    if espSphere then
                        espSphere:Destroy()
                        espSphere = nil
                    end
                end
            end)
        else
            if espConnection then
                espConnection:Disconnect()
                espConnection = nil
            end

            if espSphere then
                animateSphere(espSphere, 0)
                espSphere:Destroy()
                espSphere = nil
            end
        end
    end,
})

-- === Auto Tuck Toggle (with untuck on toggle off, lightning-fast) ===
local autoTuckEnabled = false
local autoTuckConnection
local handledFootball = {} -- track tucked footballs
local tuckDelay = 0.01 -- lightning-fast tuck timing

local AutoTuckToggle = PlayerTab:CreateToggle({
    Name = "Auto Tuck",
    CurrentValue = false,
    Flag = "AutoTuck_Toggle",
    Callback = function(value)
        autoTuckEnabled = value

        if autoTuckEnabled then
            autoTuckConnection = RunService.Heartbeat:Connect(function()
                if not player.Character then return end

                -- Check backpack
                for _, item in ipairs(player.Backpack:GetChildren()) do
                    if item.Name == "Football" and not handledFootball[item] then
                        handledFootball[item] = true
                        game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.E, false, game)
                        task.wait(tuckDelay)
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.E, false, game)
                    end
                end

                -- Check character
                for _, item in ipairs(player.Character:GetChildren()) do
                    if item.Name == "Football" and not handledFootball[item] then
                        handledFootball[item] = true
                        game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.E, false, game)
                        task.wait(tuckDelay)
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.E, false, game)
                    end
                end
            end)
        else
            -- Disconnect auto tuck
            if autoTuckConnection then
                autoTuckConnection:Disconnect()
                autoTuckConnection = nil
            end

            -- Untuck each football that was tucked
            for item, _ in pairs(handledFootball) do
                if item and item.Parent then
                    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.E, false, game)
                    task.wait(tuckDelay)
                    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.E, false, game)
                end
            end

            -- Reset tracking table
            handledFootball = {}
        end
    end,
})
